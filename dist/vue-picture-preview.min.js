!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VuePicturePreview=t():e.VuePicturePreview=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=3)}([function(e,t,i){"use strict";var n=i(8);t.a={name:"PicturePreview",props:{isPaginationEnable:{type:Boolean,default:!0},isListEnable:{type:Boolean,default:!0}},data:()=>({activeIndex:0,baseHeight:105,baseCount:3,marginTop:0,modal:!1,isTitleEnable:!0,show:!1,loadfail:!1,loading:!0,current:{title:"",src:""},slides:[],slideInstances:[]}),computed:{listBoxHeight(){return this.baseHeight*this.baseCount-5},listBoxStyles(){return{height:`${this.listBoxHeight}px`}},listUlStyles(){return{height:(this.slideInstances&&this.slideInstances.length?this.slideInstances.length*this.baseHeight:0)+"px","margin-top":`${this.marginTop}px`}}},mounted(){this.$on("on-picture-item-preview",({src:e,title:t,disabled:i})=>{this.preview({src:e,title:t,disabled:i})}),this.slotChange(),Object(n.a)(document,"keyup",this.handleKeyup)},methods:{handleKeyup(e){if(!this.modal)return;let t=e.keyCode?e.keyCode:e.witch?e.witch:window.event.keyCode;37===t||38===t?this.prevAction():39!==t&&40!==t||this.nextAction()},findChild(e){const t=function(i){i.$options.componentName?e(i):i.$children.length&&i.$children.forEach(i=>{t(i,e)})};this.slideInstances.length||!this.$children?this.slideInstances.forEach(e=>{t(e)}):this.$children.forEach(e=>{t(e)})},updateSlides(e){if(!this.$children)return;let t=[],i=1;this.findChild(n=>{t.push({$el:n.$el}),n.index=i++,e&&(n.imgload=!1,this.slideInstances.push(n))}),this.slides=t},slotChange(){this.$nextTick(()=>{this.slides=[],this.slideInstances=[],this.updateSlides(!0)})},updateOffset(){this.$ref.previewListItem},close(){this.modal=!1},preview({src:e,title:t,disabled:i}){let n=this.slideInstances.find((t,i)=>(this.activeIndex=i,t.src===e));n?i||(this.loading=!0,this.modal=!0,n.imgload?(this.loading=!1,this.current.src=n.src,this.current.title=n.title):this.getImage(n.src).then(e=>{n.imgload=!0,this.loading=!1,this.current.src=n.src,this.current.title=n.title},e=>{this.loading=!1,this.loadfail=!0})):console.error("没有查找到所需组件")},getImage:e=>new Promise(function(t,i){const n=new window.Image;n.src=e,n.onload=function(){t(n)},n.onerror=function(e){i(e)}}),prevAction(){if(!this.slideInstances.length)return;this.slideInstances.length;this.activeIndex>0&&(this.activeIndex=this.activeIndex-1,this.move("prev")),this.preview(this.slideInstances[this.activeIndex])},nextAction(){if(!this.slideInstances.length)return;let e=this.slideInstances.length-1;this.activeIndex<e&&(this.activeIndex=this.activeIndex+1,this.move("next")),this.preview(this.slideInstances[this.activeIndex])},prevImg(){this.slideInstances.length&&this.move("prev")},nextImg(){this.slideInstances.length&&this.move("next")},move(e){let t=this.baseHeight*this.baseCount-this.baseHeight*this.slideInstances.length;"next"===e&&t<0?t<this.marginTop&&(this.marginTop=this.marginTop-this.baseHeight):"prev"===e&&t<0&&this.marginTop<0&&(this.marginTop=this.marginTop+this.baseHeight)}},beforeDestroy(){Object(n.b)(document,"keyup",this.handleKeyup)}}},function(e,t,i){"use strict";t.a=function(e,t,i,n,s,a,r,o){var l=typeof(e=e||{}).default;"object"!==l&&"function"!==l||(e=e.default);var c,d="function"==typeof e?e.options:e;t&&(d.render=t,d.staticRenderFns=i,d._compiled=!0);n&&(d.functional=!0);a&&(d._scopeId=a);r?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},d._ssrRegister=c):s&&(c=o?function(){s.call(this,this.$root.$options.shadowRoot)}:s);if(c)if(d.functional){d._injectStyles=c;var h=d.render;d.render=function(e,t){return c.call(t),h(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,c):[c]}return{exports:e,options:d}}},function(e,t,i){"use strict";var n=i(12);t.a={componentName:"picture-preview-item",name:"PicturePreviewItem",mixins:[n.a],props:{src:{type:String,require:!0,default:""},disabled:{type:Boolean,default:!1},title:{type:String,default:""}},mounted(){this.$parent.slotChange()},methods:{handleClick(){if(this.disabled)return;let e=this.$parent,t=e.$options.name;for(;e&&(!t||"PicturePreview"!==t);)(e=e.$parent)&&(t=e.$options.name);e&&this.dispatch("PicturePreview","on-picture-item-preview",{src:this.src,disabled:this.disabled,title:this.title})}},beforeDestroy(){this.$parent.slotChange()}}},function(e,t,i){e.exports=i(4)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5);t.default=n.a},function(e,t,i){"use strict";var n=i(6),s=i(10),a=i(14);i.n(a);t.a={install:function(e,t){e.component("picture-preview",n.a),e.component("picture-preview-item",s.a)}}},function(e,t,i){"use strict";var n=i(0),s=i(9),a=i(1);var r=function(e){i(7)},o=Object(a.a)(n.a,s.a,s.b,!1,r,"data-v-dd87f4ee",null);t.a=o.exports},function(e,t){},function(e,t,i){"use strict";t.a=function(e,t,i,n){var s=n||!1;e.addEventListener?e.addEventListener(t,i,s):e.attachEvent?e.attachEvent("on"+t,i):e["on"+t]=i},t.b=function(e,t,i,n){var s=n||!1;e.removeEventListener?e.removeEventListener(t,i,s):e.detachEvent?e.detachEvent("on"+t,i):e["on"+t]=null}},function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return s});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"fade"}},[i("div",{on:{keyup:[function(t){if(!("button"in t)&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"]))return null;e.prevAction()},function(t){if(!("button"in t)&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"]))return null;e.nextAction()}]}},[e._t("default"),i("div",{directives:[{name:"show",rawName:"v-show",value:e.modal,expression:"modal"}],staticClass:"preview-wrapper"},[i("div",{staticClass:"preview-wrapper-box"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"preview-loading"},[i("i")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.loadfail,expression:"loadfail"}],staticClass:"preview-loading",staticStyle:{"white-space":"nowrap"}},[e._v("加载失败")]),e.current.src?i("img",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"preview-img",attrs:{src:e.current.src,alt:e.current.title}}):e._e(),i("a",{staticClass:"preview-close",attrs:{href:"javascript:void(0);"},on:{click:e.close}},[e._v("✕")]),e.isPaginationEnable?i("div",{directives:[{name:"show",rawName:"v-show",value:!e.preview.loading,expression:"!preview.loading"}],staticClass:"preview-nav-left",class:{disabled:0===e.activeIndex}},[i("a",{staticClass:"preview-nav-arrow",attrs:{href:"#",title:"上一张"},on:{click:function(t){return t.preventDefault(),e.prevAction(t)}}})]):e._e(),e.isPaginationEnable?i("div",{directives:[{name:"show",rawName:"v-show",value:!e.preview.loading,expression:"!preview.loading"}],staticClass:"preview-nav-right",class:{disabled:e.activeIndex===e.slideInstances.length-1}},[i("a",{staticClass:"preview-nav-arrow",attrs:{href:"#",title:"下一张"},on:{click:function(t){return t.preventDefault(),e.nextAction(t)}}})]):e._e()]),i("nav",{staticClass:"preview-list"},[e.isTitleEnable&&e.current.title?i("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"preview-title"},[e._v("\n                    "+e._s(e.current.title)+"\n                ")]):e._e(),e.isListEnable?i("div",[i("a",{staticClass:"preview-list-box-btn",class:{disabled:0===e.marginTop},attrs:{href:"#",title:"上一张"},on:{click:function(t){return t.preventDefault(),e.prevImg(t)}}},[e._v("上一张")]),i("div",{staticClass:"preview-list-box",style:e.listBoxStyles},[i("ul",{staticClass:"preview-list-ul",style:e.listUlStyles},e._l(e.slideInstances,function(t,n){return i("li",{key:n,staticClass:"preview-list-item",on:{click:function(i){e.preview({title:t.title,src:t.src,disabled:t.disabled})}}},[t.src?i("img",{attrs:{src:t.src,alt:"item.title"}}):e._e()])}))]),i("a",{staticClass:"preview-list-box-btn",class:{disabled:e.marginTop===-1*e.baseHeight*(e.slideInstances.length-3)},attrs:{href:"#",title:"下一张"},on:{click:function(t){return t.preventDefault(),e.nextImg(t)}}},[e._v("下一张")])]):e._e()])])],2)])},s=[]},function(e,t,i){"use strict";var n=i(2),s=i(13),a=i(1);var r=function(e){i(11)},o=Object(a.a)(n.a,s.a,s.b,!1,r,null,null);t.a=o.exports},function(e,t){},function(e,t,i){"use strict";t.a={methods:{dispatch(e,t,i){let n=this.$parent||this.$root,s=n.$options.name;for(;n&&(!s||s!==e);)(n=n.$parent)&&(s=n.$options.name);n&&n.$emit.apply(n,[t].concat(i))},broadcast(e,t,i){(function e(t,i,n){this.$children.forEach(s=>{s.$options.name===t?s.$emit.apply(s,[i].concat(n)):e.apply(s,[t,i].concat([n]))})}).call(this,e,t,i)}}}},function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return s});var n=function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{on:{click:function(t){return t.stopPropagation(),e.handleClick(t)}}},[e._t("default")],2)},s=[]},function(e,t){}])});
//# sourceMappingURL=vue-picture-preview.min.js.map